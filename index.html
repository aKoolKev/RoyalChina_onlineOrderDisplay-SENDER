<!DOCTYPE html>
<html>
<head>
    <title>Sender</title>
    <script src="https://unpkg.com/peerjs@1.5.4/dist/peerjs.min.js"></script>

    <!-- WebRTC adapter.js library to handle browser differences -->
    <script src="https://webrtc.github.io/adapter/adapter-latest.js"></script>
</head>
<body>
    <h1>Sender Page</h1>

    <p>Sender Peer ID: <span id="peer-id"></span></p>

    <h2>Connect to Receiver</h2>
    <input type="text" id="receiverIdInput" placeholder="Enter receiver's Peer ID">
    <button onclick="connect()">Connect</button>

    <b><p>STATUS:</b> 
        <span id="status-display">Not Connected</span>
    </p> 

    <h2>Data to Send</h2>
    <input type="text" id="dataInput" placeholder="Enter data to send">
    <button onclick="sendData()">Send Data</button>



    <script>
        // Test WebRTC Support
        if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
            console.log('WebRTC is supported');
        } else {
            console.log('WebRTC is not supported');
        }

       

        const peer = new Peer({
            key: 'your-peerjs-key',
            debug: 3,
            config: {
                'iceServers': [
                    { urls: 'stun:stun.l.google.com:19302' },
                    {
                        urls: 'turn:your-turn-server',
                        username: 'user',
                        credential: 'pass'
                    }
                ]
            }
        });


        peer.on('error', err => {
            console.error('PeerJS error:', err);
            if (err.type === 'browser-incompatible') {
                alert('Your browser does not support WebRTC. Please use a supported browser.');
            } else {
                alert('An error occurred: ' + err.message);
            }
        });

        let conn;

        //getting sender id
        peer.on('open', (id) => {
            document.getElementById('peer-id').innerText = id;
        });


        function connect() {
            //getting the receiver id that was provided by user
            const receiverId = document.getElementById('receiverIdInput').value;
            conn = peer.connect(receiverId);
            conn.on('open', () => {
                console.log('Connection established');
                document.getElementById('status-display').innerHTML = "Connected";
            });
        }

        function sendData() {
            const data = document.getElementById('dataInput').value;

            if (conn && conn.open) {
                conn.send(data);
                alert('Data sent');
            } else {
                alert('Connection not established. Please connect to the receiver first.');
            }
        }
    </script>
</body>
</html>
